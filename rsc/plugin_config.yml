# GLIMPS Malware Detect Host Connector - Plugin Configuration
# This file contains configuration examples for all built-in plugins (GNU/Linux only)
# Reference this file in the main config.yml using: plugins_config: /path/to/plugin_config.yml

# Extract Plugin - Archive extraction and scanning
# Extracts and scans content from various archive formats (ZIP, RAR, 7Z, TAR, GZIP, BZIP2, ISO, etc.)
extract:
  file: extract.so
  config:
    # Maximum size for individual extracted files (default: 500MB)
    # Supports human-readable units: B, KB, MB, GB, TB
    # Files exceeding this size will not be extracted
    max_file_size: 500MB

    # Maximum number of files to extract from a single archive (default: 1000)
    # Prevents extraction bombs by limiting the total number of extracted files
    max_extracted_files: 1000

    # Maximum size for an extracted archive (default: 3GB)
    # Supports human-readable units: B, KB, MB, GB, TB
    # Additional files are skipped if limit is reached
    max_total_extracted_size: 3GB

    # List of passwords to try when extracting password-protected archives
    # Default: ["infected"] - commonly used password for malware samples
    default_passwords:
      - infected

    # Custom path to 7-Zip binary (optional)
    # If not specified, the plugin will auto-detect system 7-Zip or use the embedded binary
    # seven_zip_path: /usr/bin/7z

# FileType Filter Plugin - MIME type-based file filtering
# Filters files based on their detected MIME types using libmagic
filetype_filter:
  file: filetype_filter.so
  config:
    # List of MIME types to flag as malicious (Score=1000)
    # Files with these types will be immediately marked as threats without further analysis
    forbidden_types:
      - application/x-executable
      - application/x-msdos-program
      - application/x-msdownload
      - application/x-dosexec
      - application/vnd.microsoft.portable-executable

    # List of MIME types to mark as safe (Score=-500)
    # Files with these types will be skipped from expensive analysis
    skipped_types:
      - text/plain
      - text/html
      - text/xml
      - image/jpeg
      - image/png
      - image/gif
      - image/svg+xml
      - application/json
      - application/pdf

# FilePath Filter Plugin - path based file filtering
# Filters files based on their path, using regular expressions
filepath_filter:
  file: filepath_filter.so
  config:
    # List of paths (in the form of regular expressions) to flag as malicious (Score=1000)
    # Files matching one of these paths will be immediately marked as threats without further analysis
    forbidden_paths:
      - "^/tmp/.*"         # any file in /tmp or its subfolders
      - "^/tmp/[^/]+$"     # any file strictly in /tmp (not its subfolders)
      - "^.*.exe$"         # all exe files

    # List of paths (in the form of regular expressions) to mark as safe (Score=-500)
    # Files matching one of these paths will be skipped from expensive analysis
    skipped_paths:
      - "^.*.png$"         # all png files
      - "^.*.jpg$"         # all jpg files

# FileSize Filter Plugin - File size-based filtering
# Filters files exceeding a maximum size threshold
filesize_filter:
  file: filesize_filter.so
  config:
    # Maximum file size (human-readable format)
    # Files exceeding this size are treated as threats (Score=1000)
    # Supported units: B, KB, MB, GB, TB
    # Default: 100MB
    max_size: "100MB"

# Error Filter Plugin - Analysis error handling
# Marks files with analysis errors as malicious for proper handling
# This plugin requires no configuration - it automatically flags files that encounter
# errors during analysis to ensure they are properly reviewed
error_filter:
  file: error_filter.so

# Session Plugin - Session-based file grouping and tracking
# Manages scanning sessions by grouping files based on directory structure
session:
  file: session.so
  config:
    # Directory depth for session grouping (default: 1)
    # Determines how many directory levels to use for creating session IDs
    # Example with depth=2 and root_folder="/tmp/samples/":
    #   /tmp/samples/user_a/batch1/file1.txt -> session "user_a/batch1"
    #   /tmp/samples/user_b/upload/file2.txt -> session "user_b/upload"
    # depth: 1

    # Delay before closing inactive sessions (default: 15m)
    # Sessions are closed after this duration of inactivity
    # Supports duration format: ns, us, ms, s, m, h
    # delay: 15m

    # Root folder for session path calculation (required)
    # This is the base path from which session IDs are calculated
    # Must be an absolute path
    root_folder: /tmp/samples/

    # List of base directories where session reports will be saved (required)
    # Reports are placed in <base>/<session_id>/ subdirectories
    # Example: ["/var/reports"] creates reports in /var/reports/<session_id>/
    # Leave empty to disable automatic exports
    exports: []

# Report Plugin - Report generation (PDF/HTML)
# Generates comprehensive scan reports in PDF or HTML format
report:
  file: report.so
  config:
    # Path to custom HTML template file (optional)
    # If not specified, uses the embedded default template
    # The template uses Go's html/template syntax
    # Available template data:
    #   - ScanID: Unique scan identifier
    #   - NbFileSubmitted: Total files submitted
    #   - NbFileAnalyzed: Total files analyzed
    #   - FileVolume: Total file size (human-readable)
    #   - AnalyzedVolume: Size of analyzed files
    #   - FilteredVolume: Size of filtered files
    #   - TotalMitigated: Number of threats mitigated
    #   - TotalMalware: Number of malware detected
    #   - MitigatedFiles: List of mitigated file details
    #   - MitigatedArchives: List of mitigated archive details
    #   - ScanStartTime: Scan start timestamp
    #   - Duration: Scan duration
    # template_path: /path/to/custom/template.html
    # template_path: ""
